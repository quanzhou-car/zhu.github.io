<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>泉州包车/拼车一日游 | 智能预约系统</title>
    <style>
        /* 原有样式保持不变 */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: #f8f9fa;
            line-height: 1.6;
            color: #333;
        }

        /* ...其他样式保持不变... */
		.container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 标题样式 */
        .page-header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #07c160, #059c4a);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        /* 卡片通用样式 */
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-3px);
        }

        /* 车型选择 */
        .car-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .car-card {
            border: 2px solid #e9ecef;
            cursor: pointer;
            position: relative;
        }

        .car-card.active {
            border-color: #07c160;
            background: #f0fff4;
        }

        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #07c160;
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 12px;
        }

        /* 表单样式 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            border-color: #07c160;
            outline: none;
        }

		 /* 出发地模块 */
        .location-group {
            margin: 15px 0;
        }
        .location-note {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
		
        /* 价格显示 */
        .price-display {
            font-size: 18px;
            color: #e74c3c;
            font-weight: bold;
            margin: 10px 0;
        }

        /* 联系模块 */
        .contact-floating {
            position: fixed;
            right: 25px;
            bottom: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: 8px;
            background: #f8f9fa;
            transition: all 0.3s;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .car-grid {
                grid-template-columns: 1fr;
            }
        }
   
	 .dynamic-price::before {
            content: "¥";
            font-size: 0.8em;
            margin-right: 2px;
        }
        .price-tag {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

   /* 新增接送机价格提示样式 */
        .shuttle-notice {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 8px;
            padding: 8px;
            background: #f8d7da;
            border-radius: 6px;
            display: none;
        }

        /* 伴手礼浮窗样式 */
        .gift-floating {
            position: fixed;
            left: 25px;
            bottom: 25px;
            background: linear-gradient(135deg, #ff9a9e, #fad0c4);
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            max-width: 280px;
        }

        .gift-close {
            position: absolute;
            top: 5px;
            right: 10px;
            cursor: pointer;
            font-weight: bold;
        }
	
	</style>
</head>
<body>
    <div class="container">
        <header class="page-header">
            <h1>🚗 泉州包车/拼车一日游</h1>
            <p>智能推荐 | 自由组合 | 实时计价</p>
        </header>

        <!-- 路线选择 -->
        <div class="card">
            <h2>1. 选择游玩路线</h2>
            <select id="routeSelect" class="form-control" onchange="updateAllPrices()">
                <option value="">请选择游玩路线</option>
                <option value="classic1">经典路线一（晋江梧林传统村落+永宁古镇+洛伽寺+黄金海岸+蟳埔村）</option>
                <option value="classic2">经典路线二（晋江梧林传统村落+洛伽寺+黄金海岸+小威海+六胜塔）</option>
                <option value="classic3">经典路线三（崇武古城风景区+惠女风情园+洛阳桥+风车岛+西沙湾）</option>
                <option value="culture">文化路线（开元寺+关帝庙+泉州少林寺+泉州博物馆+闽台缘博物馆）</option>
                <option value="custom">自定义路线（客服沟通）</option>
				<option value="airport">接送机/站服务（泉州站基础价80元）</option>
            </select>
        
			<div class="shuttle-notice" id="shuttleNotice">
                其他站点请咨询客服，我们将根据距离合理报价
            </div>
			
            <div class="location-group">
                <label>出发地</label>
                <input type="text" id="departure" placeholder="请输入详细出发地址" required>
                <div class="location-note">（例：泉州酒店/泉州站南广场等）</div>
            </div>
        </div>

        <!-- 套餐选择 -->
        <div class="card">
            <h2>2. 选择出行方式</h2>
            <div class="car-grid">
                <!-- 包车套餐 -->
                <div class="car-card" data-type="private" 
                     data-price='{"classic1":400,"classic2":420,"classic3":450,"culture":380,"custom":500}'>
                    <div class="badge">包车</div>
                    <h3>经济5座轿车</h3>
                    <p>一般讲解|适合2-4人小团体</p>
                    <div class="price-display dynamic-price">-</div>
                    <div class="price-tag">价格随路线变化</div>
                </div>

                <div class="car-card" data-type="private" 
                     data-price='{"classic1":450,"classic2":470,"classic3":550,"culture":430,"custom":600}'>
                    <div class="badge">包车</div>
                    <h3>舒适5座轿车（VIP尊享）</h3>
                    <p>精致讲解|司机+向导|适合2-4人小团体</p>
                    <div class="price-display dynamic-price">-</div>
                    <div class="price-tag">价格随路线变化</div>
                </div>

                <div class="car-card" data-type="private" 
                     data-price='{"classic1":650,"classic2":670,"classic3":750,"culture":600,"custom":700}'>
                    <div class="badge">包车</div>
                    <h3>商务7座MPV</h3>
                    <p>一般讲解| 家庭出游首选</p>
                    <div class="price-display dynamic-price">-</div>
                    <div class="price-tag">价格随路线变化</div>
                </div>

                <div class="car-card" data-type="private" 
                     data-price='{"classic1":700,"classic2":730,"classic3":800,"culture":650,"custom":800}'>
                    <div class="badge">包车</div>
                    <h3>商务7座MPV（VIP尊享）</h3>
                    <p>精致讲解|司机+向导| 家庭出游首选</p>
                    <div class="price-display dynamic-price">-</div>
                    <div class="price-tag">价格随路线变化</div>
                </div>

                <!-- 拼车套餐 -->
                <div class="car-card" data-type="shared">
                    <div class="badge" style="background:#3498db">拼车</div>
                    <h3>经济拼车套餐</h3>
                    <div class="price-display">¥<span id="sharedPrice">-</span>/人</div>
                    <div class="price-detail" id="priceDetail"></div>
                    <div class="form-group">
                        <label>出行人数</label>
                        <select id="sharedCount" onchange="updateSharedPrice()">
                            <option value="1">1人</option>
                            <option value="2">2人</option>
                            <option value="3">3人</option>
                            <option value="4">4人</option>
                        </select>
                    </div>
                </div>     
            
			<!-- 新增接送机专用车型 -->
                <div class="car-card" data-type="airport" 
                     data-price='{"airport":80}'>
                    <div class="badge" style="background:#ff7675">接送机</div>
                    <h3>专车接送服务</h3>
                    <p>24小时服务|准时送达|行李协助</p>
                    <div class="price-display dynamic-price">-</div>
                    <div class="price-tag">泉州站基础价</div>
                </div>
			
			</div>
        </div>

        <!-- 预订表单 -->
        <form id="bookingForm" class="card">
            <h2>3. 填写预订信息</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>出发日期</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label>出行人数</label>
                    <input type="number"  id="people" min="1" max="8" required>
                </div>
                <div class="form-group">
                    <label>联系人</label>
                    <input type="text" id="contact" placeholder="您的姓名" required>
                </div>
                <div class="form-group">
                    <label>联系电话</label>
                    <input type="tel" id="phone" placeholder="手机号码" required>
                </div>
            </div>
            <button type="submit" style="background:#07c160; color:white; padding:15px; width:100%; border:none; border-radius:8px; font-size:16px">
                🚖 立即预订
            </button>
        </form>
    </div>

    <!-- 联系模块 -->
    <div class="contact-floating">
        <div class="contact-item" onclick="showContact('wechat')">
            <img src="微信二维码.jpg" width="40" style="margin-right:10px">
            <span>微信客服</span>
        </div>
        <div class="contact-item">
            <a href="tel:177-5050-6915" style="color:#07c160; text-decoration:none">
                📞 177-5050-6915
            </a>
        </div>
    </div>

	<!-- 伴手礼浮窗 -->
        <div class="gift-floating" id="giftPopup">
            <div class="gift-close" onclick="closeGift()">×</div>
            <img src="伴手礼.jpg" alt="簪花" width="50" height="50">
          <div>
            <h4 style="margin:0">下单即送！</h4>
              <p style="margin:5px 0;font-size:14px">&nbsp; 鲟浦簪花非遗伴手礼</p>
              <small>（价值¥68，每日限量10份）</small>
            </div>
        </div>
	
    <script>
        // 初始化执行
        document.addEventListener('DOMContentLoaded', function() {
            updateAllPrices();
        });

		// 新增车型选择交互
document.querySelectorAll('.car-card').forEach(card => {
    card.addEventListener('click', function() {
        // 清除其他卡片的选中状态
        document.querySelectorAll('.car-card').forEach(c => c.classList.remove('active'));
        this.classList.add('active');
    });
});
		
        // 统一更新所有价格
        function updateAllPrices() {
            updatePrivatePrices();
            updateSharedPrice();
        }

        // 更新后的统一函数
function updatePrivatePrices() {
    const route = document.getElementById('routeSelect').value;
    document.getElementById('shuttleNotice').style.display = 
        route === 'airport' ? 'block' : 'none';

    document.querySelectorAll('[data-type="private"], [data-type="airport"]').forEach(card => {
        const prices = JSON.parse(card.dataset.price);
        const priceDisplay = card.querySelector('.dynamic-price');
        priceDisplay.textContent = route ? (prices[route] || '联系客服') : '-';
    });
}
        // 伴手礼浮窗控制
        function closeGift() {
            document.getElementById('giftPopup').style.display = 'none';
        }

        // 页面加载5秒后显示浮窗
        setTimeout(() => {
            document.getElementById('giftPopup').style.display = 'flex';
        }, 5000);
		
        // 拼车价格配置
        const routePrices = {
            classic1: { base: 120 },
            classic2: { base: 120 },
            classic3: { base: 150 },
            culture:  { base: 100 },
            custom:   { base: 150 }
        };

        // 更新拼车价格
        function updateSharedPrice() {
            const route = document.getElementById('routeSelect').value;
            const count = parseInt(document.getElementById('sharedCount').value);
            
            if(!route || !routePrices[route]) {
                document.getElementById('sharedPrice').textContent = '-';
                return;
            }

            const basePrice = routePrices[route].base;
            let discount = count >= 2 ? (count-1)*5 : 0;
            if(count === 4) discount = 20;
            
            const finalPrice = basePrice - discount;
            
            document.getElementById('sharedPrice').textContent = finalPrice;
            document.getElementById('priceDetail').innerHTML = 
                `基础价：¥${basePrice}/人<br>
                同行优惠：-¥${discount}`;
        }

        // 表单提交
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    // 新增套餐验证
    const selectedCar = document.querySelector('.car-card.active');
    if (!selectedCar) {
        alert('请先选择出行方式');
        return;
    }
			
			// 验证出发地（保留原有验证）
    const departure = document.getElementById('departure').value;
    if (!departure || departure.length < 3) {
      alert('请输入有效的出发地址');
      return;
    }

    // 收集表单数据
    const formData = {
      "路线": document.getElementById('routeSelect').value,
      "出发地": departure,
      "日期": document.getElementById('date').value,
      "人数": document.getElementById('people').value,
      "联系人": document.getElementById('contact').value,
      "电话": document.getElementById('phone').value
    };

    // 替换为你的维格表API信息
    const VIKA_API_TOKEN = 'uskCDWPQN9ix0UvicSFpUxH';
    const VIKA_DATASHEET_ID = 'dstite2QQsmTky2NoP';

    try {
      const response = await fetch(`https://api.vika.cn/v1/datasheets/${VIKA_DATASHEET_ID}/records`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${VIKA_API_TOKEN}`
        },
        body: JSON.stringify({ records: [{ fields: formData }] })
      });
      if (response.ok) {
        alert('提交成功！客服将尽快联系您');
        document.getElementById('bookingForm').reset();
      } else {
        alert('提交失败，请稍后重试');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('网络错误，请联系客服');
    }
  });
    </script>
</body>
</html>
